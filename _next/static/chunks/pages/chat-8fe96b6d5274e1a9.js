(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{22:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return s(762)}])},762:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return i}});var n=s(5893),r=s(7294),a=s(2798),c=s(1163),l=s(3878);function i(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(""),[o,u]=(0,r.useState)(!1),h=(0,r.useRef)(null),d=(0,c.useRouter)();(0,r.useEffect)(()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){let t=new e;t.lang="en-IN",t.interimResults=!1,t.maxAlternatives=1,t.onresult=e=>{let t=e.results[0][0].transcript;i(e=>e?e+" "+t:t)},t.onend=()=>u(!1),h.current=t}},[]);let x=()=>{if(h.current)try{h.current.start(),u(!0)}catch(e){console.debug(e)}},p=()=>{if(h.current)try{h.current.stop()}catch(e){}u(!1)},m=async e=>{let n=(null!=e?e:s).trim();if(n){t(e=>[...e,{from:"user",text:n}]),i("");try{let e=await fetch((0,a.JW)("/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})});if(!e.ok)throw Error("chat failed");let s=await e.json();t(e=>[...e,{from:"bot",text:s.reply}])}catch(e){t(e=>[...e,{from:"bot",text:"Sorry, chat service unavailable."}])}}};return(0,n.jsx)("div",{className:"min-h-screen bg-neutral-50 py-8",children:(0,n.jsxs)("div",{className:"max-w-3xl mx-auto px-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Crop Health Chat"}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(l.zx,{variant:"ghost",onClick:()=>d.push("/"),children:"Back"})})]}),(0,n.jsx)(l.Zb,{className:"p-4 mb-4",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-sm text-neutral-600",children:"Ask about crop health, pests, market prices, or weather. You can type or speak â€” we'll convert voice to text."}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(l.zx,{onClick:()=>o?p():x(),children:o?"Stop":"Speak"}),(0,n.jsx)(l.zx,{onClick:()=>{i("")},children:"Clear"})]})]})}),(0,n.jsx)("div",{className:"space-y-3 mb-6",children:e.map((e,t)=>(0,n.jsx)("div",{className:"user"===e.from?"text-right":"text-left",children:(0,n.jsx)("div",{className:"inline-block px-4 py-2 rounded-lg ".concat("user"===e.from?"bg-primary-600 text-white":"bg-white border"),children:e.text})},t))}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(l.II,{value:s,onChange:e=>i(e.target.value),placeholder:"Type your question"}),(0,n.jsx)(l.zx,{onClick:()=>m(),disabled:!s,children:"Send"})]})]})})}}},function(e){e.O(0,[942,888,774,179],function(){return e(e.s=22)}),_N_E=e.O()}]);